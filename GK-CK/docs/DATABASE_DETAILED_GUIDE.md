# H∆Ø·ªöNG D·∫™N MYSQL CHO H·ªÜ TH·ªêNG QU·∫¢N L√ù KHO

## üéØ T·ªïng quan
Phi√™n b·∫£n MySQL c·ªßa h·ªá th·ªëng qu·∫£n l√Ω kho cung c·∫•p:
- ‚úÖ **D·ªÖ c√†i ƒë·∫∑t**: MySQL mi·ªÖn ph√≠ v√† c√≥ s·∫µn trong XAMPP/WAMP
- ‚úÖ **Cross-platform**: Ch·∫°y ƒë∆∞·ª£c tr√™n Windows, Linux, Mac
- ‚úÖ **High Performance**: T·ªëi ∆∞u cho ·ª©ng d·ª•ng nh·ªè v√† v·ª´a
- ‚úÖ **Community Support**: T√†i li·ªáu phong ph√∫, c·ªông ƒë·ªìng l·ªõn
- ‚úÖ **Cloud Ready**: D·ªÖ deploy l√™n cloud (AWS, Google Cloud, etc.)

## üöÄ Quick Start

### B∆∞·ªõc 1: C√†i ƒë·∫∑t MySQL
```bash
# Option A: T·∫£i MySQL Community Server
https://dev.mysql.com/downloads/mysql/

# Option B: S·ª≠ d·ª•ng XAMPP (khuy·∫øn ngh·ªã cho ng∆∞·ªùi m·ªõi)
https://www.apachefriends.org/download.html

# Option C: S·ª≠ d·ª•ng Docker
docker run --name mysql-kho -e MYSQL_ROOT_PASSWORD=123456 -p 3306:3306 -d mysql:8.0
```

### B∆∞·ªõc 2: Setup Database
```bash
# Ch·∫°y script t·ª± ƒë·ªông
setup_mysql.bat

# Ho·∫∑c manual setup:
mysql -u root -p -e "CREATE DATABASE QuanLyKho_MySQL;"
mysql -u root -p QuanLyKho_MySQL < database_mysql.sql
```

### B∆∞·ªõc 3: Compile v√† ch·∫°y
```bash
# T·∫£i MySQL Connector/J v√† ƒë·∫∑t t√™n mysql-connector-java.jar
compile_mysql.bat

# Ch·∫°y GUI
run_mysql_gui.bat

# Ho·∫∑c ch·∫°y Console
run_mysql_console.bat
```

## üìÅ C·∫•u tr√∫c files MySQL

```
MySQL Database Files:
‚îú‚îÄ‚îÄ database_mysql.sql          # Schema v√† stored procedures
‚îú‚îÄ‚îÄ database_mysql.properties   # C·∫•u h√¨nh k·∫øt n·ªëi
‚îú‚îÄ‚îÄ DatabaseConnectionMySQL.java # Connection manager
‚îú‚îÄ‚îÄ HangHoaDAOMySQL.java        # Data access layer
‚îú‚îÄ‚îÄ setup_mysql.bat             # Auto setup script
‚îú‚îÄ‚îÄ compile_mysql.bat           # Compile v·ªõi MySQL
‚îú‚îÄ‚îÄ run_mysql_console.bat       # Ch·∫°y console
‚îú‚îÄ‚îÄ run_mysql_gui.bat           # Ch·∫°y GUI
‚îî‚îÄ‚îÄ mysql-connector-java.jar    # JDBC driver (c·∫ßn t·∫£i)
```

## üóÉÔ∏è Database Schema

### B·∫£ng ch√≠nh
```sql
-- B·∫£ng cha l∆∞u th√¥ng tin chung
CREATE TABLE HangHoa (
    MaHang VARCHAR(10) PRIMARY KEY,
    TenHang VARCHAR(100) NOT NULL,
    LoaiHang ENUM('ThucPham', 'DienMay', 'SanhSu') NOT NULL,
    SoLuongTon INT NOT NULL DEFAULT 0,
    DonGia DECIMAL(15,2) NOT NULL,
    VAT DECIMAL(4,3) NOT NULL,
    NgayTao DATETIME DEFAULT CURRENT_TIMESTAMP,
    NgayCapNhat DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- B·∫£ng con cho th·ª±c ph·∫©m
CREATE TABLE ThucPham (
    MaHang VARCHAR(10) PRIMARY KEY,
    NgaySanXuat DATE NOT NULL,
    NgayHetHan DATE NOT NULL,
    NhaCungCap VARCHAR(100) NOT NULL,
    FOREIGN KEY (MaHang) REFERENCES HangHoa(MaHang) ON DELETE CASCADE
);

-- B·∫£ng con cho ƒëi·ªán m√°y
CREATE TABLE DienMay (
    MaHang VARCHAR(10) PRIMARY KEY,
    ThoiGianBaoHanh INT NOT NULL DEFAULT 12,
    CongSuat DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (MaHang) REFERENCES HangHoa(MaHang) ON DELETE CASCADE
);

-- B·∫£ng con cho s√†nh s·ª©
CREATE TABLE SanhSu (
    MaHang VARCHAR(10) PRIMARY KEY,
    NhaSanXuat VARCHAR(100) NOT NULL,
    NgayNhapKho DATE NOT NULL,
    FOREIGN KEY (MaHang) REFERENCES HangHoa(MaHang) ON DELETE CASCADE
);
```

### B·∫£ng audit
```sql
-- B·∫£ng log audit
CREATE TABLE HangHoa_Audit (
    AuditID INT AUTO_INCREMENT PRIMARY KEY,
    MaHang VARCHAR(10),
    ThaoTac ENUM('INSERT', 'UPDATE', 'DELETE'),
    DuLieuCu JSON,
    DuLieuMoi JSON,
    NguoiThucHien VARCHAR(100) DEFAULT USER(),
    ThoiGian DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

## üîß Stored Procedures

### Th√™m h√†ng h√≥a
```sql
-- Th√™m th·ª±c ph·∫©m v·ªõi validation
DELIMITER //
CREATE PROCEDURE SP_ThemThucPham(
    IN p_MaHang VARCHAR(10),
    IN p_TenHang VARCHAR(100),
    IN p_SoLuongTon INT,
    IN p_DonGia DECIMAL(15,2),
    IN p_NgaySanXuat DATE,
    IN p_NgayHetHan DATE,
    IN p_NhaCungCap VARCHAR(100)
)
BEGIN
    DECLARE v_count INT DEFAULT 0;
    DECLARE EXIT HANDLER FOR SQLEXCEPTION
    BEGIN
        ROLLBACK;
        SELECT 'ERROR' AS Result, 'L·ªói th√™m th·ª±c ph·∫©m!' AS Message;
    END;
    
    START TRANSACTION;
    
    -- Ki·ªÉm tra m√£ h√†ng ƒë√£ t·ªìn t·∫°i
    SELECT COUNT(*) INTO v_count FROM HangHoa WHERE MaHang = p_MaHang;
    IF v_count > 0 THEN
        SELECT 'ERROR' AS Result, 'M√£ h√†ng ƒë√£ t·ªìn t·∫°i!' AS Message;
        ROLLBACK;
    ELSE
        -- Th√™m v√†o b·∫£ng HangHoa
        INSERT INTO HangHoa (MaHang, TenHang, LoaiHang, SoLuongTon, DonGia, VAT)
        VALUES (p_MaHang, p_TenHang, 'ThucPham', p_SoLuongTon, p_DonGia, 0.05);
        
        -- Th√™m v√†o b·∫£ng ThucPham
        INSERT INTO ThucPham (MaHang, NgaySanXuat, NgayHetHan, NhaCungCap)
        VALUES (p_MaHang, p_NgaySanXuat, p_NgayHetHan, p_NhaCungCap);
        
        COMMIT;
        SELECT 'SUCCESS' AS Result, 'Th√™m th·ª±c ph·∫©m th√†nh c√¥ng!' AS Message;
    END IF;
END //
DELIMITER ;
```

### T√¨m s·∫£n ph·∫©m s·∫Øp h·∫øt h·∫°n
```sql
DELIMITER //
CREATE PROCEDURE SP_TimSanPhamSapHetHan()
BEGIN
    SELECT h.MaHang, h.TenHang, tp.NgayHetHan,
           DATEDIFF(tp.NgayHetHan, CURDATE()) AS SoNgayConLai
    FROM HangHoa h
    JOIN ThucPham tp ON h.MaHang = tp.MaHang
    WHERE tp.NgayHetHan BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 7 DAY)
    ORDER BY tp.NgayHetHan ASC;
END //
DELIMITER ;
```

## üìä Views v√† Functions

### View t·ªïng h·ª£p
```sql
-- View hi·ªÉn th·ªã th√¥ng tin ƒë·∫ßy ƒë·ªß
CREATE VIEW VW_HangHoaChiTiet AS
SELECT 
    h.MaHang,
    h.TenHang,
    h.LoaiHang,
    h.SoLuongTon,
    h.DonGia,
    h.VAT,
    (h.DonGia * (1 + h.VAT)) AS GiaBanTinhVAT,
    tp.NgaySanXuat,
    tp.NgayHetHan,
    tp.NhaCungCap,
    dm.ThoiGianBaoHanh,
    dm.CongSuat,
    ss.NhaSanXuat,
    ss.NgayNhapKho,
    h.NgayTao,
    h.NgayCapNhat
FROM HangHoa h
LEFT JOIN ThucPham tp ON h.MaHang = tp.MaHang
LEFT JOIN DienMay dm ON h.MaHang = dm.MaHang
LEFT JOIN SanhSu ss ON h.MaHang = ss.MaHang;
```

### Functions ti·ªán √≠ch
```sql
-- Function t√≠nh t·ªïng gi√° tr·ªã kho
DELIMITER //
CREATE FUNCTION FN_TinhTongGiaTriKho() RETURNS DECIMAL(20,2)
READS SQL DATA
DETERMINISTIC
BEGIN
    DECLARE v_total DECIMAL(20,2) DEFAULT 0;
    SELECT SUM(SoLuongTon * DonGia * (1 + VAT)) INTO v_total FROM HangHoa;
    RETURN IFNULL(v_total, 0);
END //
DELIMITER ;
```

## üîí Triggers

### Audit triggers
```sql
-- Trigger audit cho INSERT
DELIMITER //
CREATE TRIGGER TR_HangHoa_Insert_Audit
AFTER INSERT ON HangHoa
FOR EACH ROW
BEGIN
    INSERT INTO HangHoa_Audit (MaHang, ThaoTac, DuLieuMoi)
    VALUES (NEW.MaHang, 'INSERT', JSON_OBJECT(
        'MaHang', NEW.MaHang,
        'TenHang', NEW.TenHang,
        'LoaiHang', NEW.LoaiHang,
        'SoLuongTon', NEW.SoLuongTon,
        'DonGia', NEW.DonGia,
        'VAT', NEW.VAT
    ));
END //
DELIMITER ;
```

## ‚öôÔ∏è C·∫•u h√¨nh k·∫øt n·ªëi

### File database_mysql.properties
```properties
# MySQL Database Configuration
mysql.host=localhost
mysql.port=3306
mysql.database=QuanLyKho_MySQL
mysql.username=root
mysql.password=your_password_here

# Connection Pool Settings
mysql.initialPoolSize=5
mysql.maxPoolSize=20
mysql.acquireIncrement=2
mysql.maxIdleTime=3600
mysql.connectionTimeout=30000

# Advanced Settings
mysql.useSSL=false
mysql.allowPublicKeyRetrieval=true
mysql.serverTimezone=Asia/Ho_Chi_Minh
mysql.characterEncoding=UTF-8
```

### L·ªõp DatabaseConnectionMySQL
```java
public class DatabaseConnectionMySQL {
    private static DatabaseConnectionMySQL instance;
    private String url;
    private String username;
    private String password;
    
    private DatabaseConnectionMySQL() {
        loadProperties();
    }
    
    public static synchronized DatabaseConnectionMySQL getInstance() {
        if (instance == null) {
            instance = new DatabaseConnectionMySQL();
        }
        return instance;
    }
    
    public Connection getConnection() throws SQLException {
        return DriverManager.getConnection(url, username, password);
    }
}
```

## üß™ Testing

### Test k·∫øt n·ªëi
```bash
# Test connection class
java -cp .;mysql-connector-java.jar DatabaseConnectionMySQL

# Test DAO operations
java -cp .;mysql-connector-java.jar HangHoaDAOMySQL
```

### Test SQL tr·ª±c ti·∫øp
```sql
-- Test stored procedures
CALL SP_ThemThucPham('TEST001', 'Test Product', 10, 25000, '2024-01-01', '2024-12-31', 'Test Supplier');
CALL SP_LayDanhSachHangHoa();
CALL SP_TimSanPhamSapHetHan();

-- Test views
SELECT * FROM VW_HangHoaChiTiet WHERE LoaiHang = 'ThucPham';

-- Test functions
SELECT FN_TinhTongGiaTriKho() AS TongGiaTriKho;
```

## üîß Troubleshooting

### L·ªói th∆∞·ªùng g·∫∑p

#### 1. L·ªói k·∫øt n·ªëi MySQL
```
Error: Access denied for user 'root'@'localhost'
Solution: Ki·ªÉm tra username/password trong database_mysql.properties
```

#### 2. L·ªói timezone
```
Error: The server time zone value 'xxx' is unrecognized
Solution: Th√™m ?serverTimezone=Asia/Ho_Chi_Minh v√†o connection string
```

#### 3. L·ªói SSL
```
Error: SSL connection required
Solution: Th√™m ?useSSL=false v√†o connection string
```

#### 4. L·ªói JDBC Driver
```
Error: No suitable driver found
Solution: T·∫£i mysql-connector-java.jar t·ª´ https://dev.mysql.com/downloads/connector/j/
```

### Performance tuning
```sql
-- T·ªëi ∆∞u performance
-- 1. Th√™m indexes
CREATE INDEX IDX_HangHoa_LoaiHang ON HangHoa(LoaiHang);
CREATE INDEX IDX_ThucPham_NgayHetHan ON ThucPham(NgayHetHan);
CREATE INDEX IDX_HangHoa_TenHang ON HangHoa(TenHang);

-- 2. Optimize tables
OPTIMIZE TABLE HangHoa;
OPTIMIZE TABLE ThucPham;
OPTIMIZE TABLE DienMay;
OPTIMIZE TABLE SanhSu;

-- 3. Analyze performance
EXPLAIN SELECT * FROM VW_HangHoaChiTiet WHERE LoaiHang = 'ThucPham';
```

## üåê Deployment Options

### Local Development
```bash
# XAMPP/WAMP
1. C√†i XAMPP/WAMP
2. Start MySQL service
3. Import database_mysql.sql qua phpMyAdmin
4. Ch·∫°y ·ª©ng d·ª•ng
```

### Production
```bash
# MySQL Server
1. C√†i MySQL Server 8.0+
2. T·∫°o user ri√™ng cho ·ª©ng d·ª•ng
3. Set privileges ph√π h·ª£p
4. Backup ƒë·ªãnh k·ª≥
```

### Cloud Deployment
```bash
# AWS RDS
1. T·∫°o RDS MySQL instance
2. C·∫≠p nh·∫≠t security groups
3. Update connection string
4. Deploy ·ª©ng d·ª•ng l√™n EC2

# Google Cloud SQL
1. T·∫°o Cloud SQL MySQL instance
2. Set authorized networks
3. Update connection properties
4. Deploy to App Engine/GKE
```

## üìà Monitoring

### Database monitoring
```sql
-- Ki·ªÉm tra performance
SHOW PROCESSLIST;
SHOW ENGINE INNODB STATUS;

-- Ki·ªÉm tra size database
SELECT 
    table_schema AS 'Database',
    ROUND(SUM(data_length + index_length) / 1024 / 1024, 2) AS 'Size (MB)'
FROM information_schema.tables
WHERE table_schema = 'QuanLyKho_MySQL'
GROUP BY table_schema;

-- Audit log summary
SELECT ThaoTac, COUNT(*) as SoLuong, DATE(ThoiGian) as Ngay
FROM HangHoa_Audit
GROUP BY ThaoTac, DATE(ThoiGian)
ORDER BY Ngay DESC;
```

## üîÑ Migration t·ª´ SQL Server

### B∆∞·ªõc chuy·ªÉn ƒë·ªïi
1. **Export data** t·ª´ SQL Server
2. **Convert scripts** sang MySQL syntax
3. **Update Java code** ƒë·ªÉ s·ª≠ d·ª•ng MySQL DAO
4. **Test thoroughly** tr∆∞·ªõc khi production
5. **Backup** data tr∆∞·ªõc khi switch

### Script migration helper
```sql
-- Convert SQL Server data types to MySQL
-- NVARCHAR -> VARCHAR with utf8mb4
-- DATETIME -> DATETIME
-- MONEY -> DECIMAL(15,2)
-- IDENTITY -> AUTO_INCREMENT
```

## üìö T√†i li·ªáu tham kh·∫£o

- **MySQL Official Docs**: https://dev.mysql.com/doc/
- **MySQL Connector/J**: https://dev.mysql.com/doc/connector-j/8.0/en/
- **MySQL Performance**: https://dev.mysql.com/doc/refman/8.0/en/optimization.html
- **MySQL Security**: https://dev.mysql.com/doc/refman/8.0/en/security.html

---

## ‚ú® K·∫øt lu·∫≠n

Phi√™n b·∫£n MySQL c·ªßa h·ªá th·ªëng qu·∫£n l√Ω kho cung c·∫•p:
- üéØ **Easy Setup**: Setup nhanh v·ªõi XAMPP/WAMP
- üöÄ **High Performance**: T·ªëi ∆∞u cho ·ª©ng d·ª•ng SME
- üí∞ **Cost Effective**: Mi·ªÖn ph√≠ v√† open source
- üåç **Cross Platform**: H·ªó tr·ª£ ƒëa n·ªÅn t·∫£ng
- ‚òÅÔ∏è **Cloud Ready**: D·ªÖ d√†ng deploy l√™n cloud

H·ªá th·ªëng ƒë√£ s·∫µn s√†ng cho production v·ªõi ƒë·∫ßy ƒë·ªß features enterprise nh∆∞ audit trail, stored procedures, triggers, v√† performance optimization!
